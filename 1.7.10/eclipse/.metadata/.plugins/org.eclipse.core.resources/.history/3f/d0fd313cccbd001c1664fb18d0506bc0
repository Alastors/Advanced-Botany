package ab.common.core.proxy.packet;

import ab.client.core.handler.ItemsRemainingRender;
import ab.common.item.relic.ItemSphereNavigation;
import cpw.mods.fml.common.network.ByteBufUtils;
import cpw.mods.fml.common.network.simpleimpl.IMessage;
import cpw.mods.fml.common.network.simpleimpl.IMessageHandler;
import cpw.mods.fml.common.network.simpleimpl.MessageContext;
import cpw.mods.fml.relauncher.Side;
import cpw.mods.fml.relauncher.SideOnly;
import io.netty.buffer.ByteBuf;
import net.minecraft.block.Block;
import net.minecraft.client.Minecraft;
import net.minecraft.entity.player.EntityPlayer;
import net.minecraft.world.WorldServer;
import net.minecraftforge.common.DimensionManager;

public class S01PacketFindNearBlocks implements IMessage, IMessageHandler<S01PacketFindNearBlocks, IMessage> {
	
	private String username;
	private int blockID;
	private int meta;
	
	public S01PacketFindNearBlocks() {};
	
	public S01PacketFindNearBlocks(EntityPlayer player, Block block, int meta) {
		this.username = player.getCommandSenderName();
		this.blockID = Block.getIdFromBlock(block);
		this.meta = meta;
	}

	public void toBytes(ByteBuf buf) {
		buf.writeInt(this.blockID);
		ByteBufUtils.writeUTF8String(buf, this.username);
		buf.writeInt(this.meta);
	}
	
	public void fromBytes(ByteBuf buf) {
		this.blockID = buf.readByte();
		this.username = ByteBufUtils.readUTF8String(buf);
		this.meta = buf.readByte();
	}
	
	@SideOnly(Side.CLIENT)
	public IMessage onMessage(S01PacketFindNearBlocks message, MessageContext ctx) {
		ItemSphereNavigation.findBlocks(Minecraft.getMinecraft().theWorld, Block.getBlockById(message.blockID), message.meta, Minecraft.getMinecraft().theWorld.getPlayerEntityByName(message.username));
		return null;
	}
}
